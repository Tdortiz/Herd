<div class="row">
    <!-- Banner Image -->
    <div class="header-image-box">
        <img class="header-pic" src="{{ account?.MastodonHeaderImageURL }}" />
    </div>

    <div class="row profile-content">
        <!-- Left Column -->
        <div class="col-sm-3">
            <div class="col-lg-12">
                <div class="profile-image-box">
                    <img *ngIf="account" class="profile-pic" src="{{ account?.MastodonProfileImageURL }}" />
                </div>
                <div class="panel">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-sm-8">
                                <p>
                                    <strong>{{ account?.MastodonDisplayName }}</strong>
                                    <br />
                                    @{{ account?.MastodonUserName }}
                                </p>
                            </div>
                            <div *ngIf="account && !isCurrentUser()" class="col-sm-4">
                                <button *ngIf="isFollowing" class="btn btn-primary follow-btn" (mouseenter)="followUnfollowText = 'Unfollow';" (mouseleave)="followUnfollowText = 'Following';" (click)="togglefollow()">
                                    {{followUnfollowText}}
                                </button>
                                <button *ngIf="!isFollowing" class="btn btn-secondary not-following-btn" (click)="togglefollow()">
                                    Follow
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="row col-sm-12">
                            <p [innerHTML]="account?.MastodonShortBio"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
        <!-- Middle Column -->
        <div class="col-sm-6">
            <div class="info-bar">
                <div class="panel">
                    <div class="panel-body">
                        <tabset #staticTabs>
                            <tab heading="Posts ({{ account?.PostCount }})">
                                <ng-container *ngIf="account">
                                    <div class="panel">
                                        <div class="panel-heading text-center" style="min-height: 50px;">
                                            <div>
                                                <div *ngIf="loading" class="btn pull-left">
                                                    <fa name="spinner" spin=true></fa>
                                                </div>
                                                <button *ngIf="newItems.length > 0" class="btn btn-primary" type="button" (click)="viewNewStatuses()">{{newItems.length}} New Statuses</button>
                                                <button class="btn btn-primary pull-right" type="button" (click)="scrollToTop('statuses')"><fa name="chevron-up"></fa>Scroll to top</button>
                                            </div>
                                        </div>
                                        <div #statusesWrapper class="panel-body statusesWrapper"
                                             data-infinite-scroll
                                             debounce
                                             [infiniteScrollContainer]="statusesWrapper"
                                             [scrollWindow]="false"
                                             [infiniteScrollDistance]="3"
                                             [infiniteScrollThrottle]="1500"
                                             (scrolled)="onScrollDown($event, 'statuses')">

                                            <div *ngFor="let status of userPosts">
                                                <status [status]="status"></status>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </tab>
                            <tab heading="Following ({{ account?.FollowingCount }})">
                                <div class="row">
                                    <ng-container *ngIf="account">
                                        <div class="panel">
                                            <div class="panel-heading text-center" style="min-height: 50px;">
                                                <div>
                                                    <div *ngIf="loading" class="btn pull-left">
                                                        <fa name="spinner" spin=true></fa>
                                                    </div>
                                                    <button class="btn btn-primary pull-right" type="button" (click)="scrollToTop('following')"><fa name="chevron-up"></fa>Scroll to top</button>
                                                </div>
                                            </div>
                                            <div #followingWrapper class="panel-body statusesWrapper"
                                                 data-infinite-scroll
                                                 debounce
                                                 [infiniteScrollContainer]="followingWrapper"
                                                 [scrollWindow]="false"
                                                 [infiniteScrollDistance]="3"
                                                 [infiniteScrollThrottle]="1500"
                                                 (scrolled)="onScrollDown($event, 'following')">

                                                <div *ngFor="let userCard of following" class="text-center">
                                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6">
                                                        <usercard [userCard]="userCard" showBio="true" showActions="true" showFollowButton="true"></usercard>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>
                                </div> 
                            </tab>
                            <tab heading="Followers ({{ account?.FollowersCount }})">
                                <ng-container *ngIf="account">
                                    <div class="panel">
                                        <div class="panel-heading text-center" style="min-height: 50px;">
                                            <div>
                                                <div *ngIf="loading" class="btn pull-left">
                                                    <fa name="spinner" spin=true></fa>
                                                </div>
                                                <button class="btn btn-primary pull-right" type="button" (click)="scrollToTop('followers')"><fa name="chevron-up"></fa>Scroll to top</button>
                                            </div>
                                        </div>
                                        <div #followersWrapper class="panel-body statusesWrapper"
                                             data-infinite-scroll
                                             debounce
                                             [infiniteScrollContainer]="followersWrapper"
                                             [scrollWindow]="false"
                                             [infiniteScrollDistance]="3"
                                             [infiniteScrollThrottle]="1500"
                                             (scrolled)="onScrollDown($event, 'followers')">

                                            <div class="row">
                                                <div *ngFor="let userCard of followers" class="text-center">
                                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6">
                                                        <usercard [userCard]="userCard" showBio="true" showActions="true" showFollowButton="true"></usercard>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </tab>
                        </tabset>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Right Column -->
        <div class="col-sm-3">
            <div class="panel pushTop">
                <div class="panel-heading">
                    <h3>Future Box</h3>
                </div>
                <div class="panel-body">
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Modals -->

<bs-modal #specificStatusModal>
    <bs-modal-header [showDismiss]="true"></bs-modal-header>
    <bs-modal-body>
        <div *ngIf="specificStatus">
            <div class="ancestors" *ngFor="let anscestorStatus of specificStatus.Ancestors">
                <status [status]="anscestorStatus"></status>
            </div>
            <div class="viewingStatus">
                <status [status]="specificStatus"></status>
            </div>
            <status-form actionName="Reply" isReply="true" [inReplyToId]="specificStatus.IdString"></status-form>
            <div class="replies" *ngFor="let descendantStatus of specificStatus.Descendants">
                <status [status]="descendantStatus"></status>
            </div>
        </div>
    </bs-modal-body>
    <bs-modal-footer [showDefaultButtons]="false"></bs-modal-footer>
</bs-modal>

<bs-modal #replyStatusModal>
    <bs-modal-header [showDismiss]="true"></bs-modal-header>
    <bs-modal-body>
        <div *ngIf="replyStatus">
            <div class="viewingStatus">
                <status [status]="replyStatus"></status>
            </div>
            <status-form actionName="Reply" isReply="true" [inReplyToId]="replyStatus.IdString"></status-form>
        </div>
    </bs-modal-body>
    <bs-modal-footer [showDefaultButtons]="false"></bs-modal-footer>
</bs-modal>